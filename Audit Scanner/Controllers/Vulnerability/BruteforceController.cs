using System.Collections.Generic;
using System.IO;
using System.Linq;
using Audit_Scanner.Models;
using Audit_Scanner.Vulnerability.Models;

namespace Audit_Scanner.Controllers.Vulnerability
{
    public class BruteforceController
    {
        
        private List<CredentialModel> Credentials { get; set; }
        private static string _CSVPath = @"..\..\Resources\Credentials.csv";
        
        public BruteforceController()
        {
            var credentialList = new List<CredentialModel>();

            if (File.Exists(_CSVPath))
            {
                try
                {
                    using (var csvReader = new StreamReader(_CSVPath))
                    {
                        while (!csvReader.EndOfStream)
                        {
                            var line = csvReader.ReadLine();
                            var entries = line.Split(',');

                            var combo = new CredentialModel
                            {
                                Manufacturer = entries[0],
                                Username = entries[1],
                                Password = entries[2]
                            };

                            credentialList.Add(combo);
                        }
                    }

                    Credentials = credentialList.Distinct().ToList();
                }
                catch
                {
                    // Reading Resources/Credentials.csv failed. 
                    
                }
            }
        }
        
        public CredentialModel BruteforceTelnet()
        {
            
            
            return Credentials.FirstOrDefault();
        }
        
        public CredentialModel BruteforceSSH(DeviceModel target)
        {
            
            
            return Credentials.FirstOrDefault();
        }
    }
}